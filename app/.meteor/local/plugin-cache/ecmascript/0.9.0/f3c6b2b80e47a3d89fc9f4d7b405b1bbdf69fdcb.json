{"metadata":{"usedHelpers":["classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"meteor/underscore","imported":["_"],"specifiers":[{"kind":"named","imported":"_","local":"_"}]},{"source":"./published_document","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PublishedDocument"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/reywood:publish-composite/lib/published_document_list.js","filenameRelative":"packages/reywood:publish-composite/lib/published_document_list.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/reywood:publish-composite/lib/published_document_list.js.map","sourceFileName":"packages/reywood:publish-composite/lib/published_document_list.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"published_document_list"},"ignored":false,"code":"var _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _ = void 0;\n\nmodule.watch(require(\"meteor/underscore\"), {\n    _: function (v) {\n        _ = v;\n    }\n}, 0);\nvar PublishedDocument = void 0;\nmodule.watch(require(\"./published_document\"), {\n    \"default\": function (v) {\n        PublishedDocument = v;\n    }\n}, 1);\n\nvar PublishedDocumentList = function () {\n    function PublishedDocumentList() {\n        (0, _classCallCheck3.default)(this, PublishedDocumentList);\n        this.documents = {};\n    }\n\n    PublishedDocumentList.prototype.add = function () {\n        function add(collectionName, docId) {\n            var key = valueOfId(docId);\n\n            if (!this.documents[key]) {\n                this.documents[key] = new PublishedDocument(collectionName, docId);\n            }\n        }\n\n        return add;\n    }();\n\n    PublishedDocumentList.prototype.addChildPub = function () {\n        function addChildPub(docId, publication) {\n            if (!publication) {\n                return;\n            }\n\n            var key = valueOfId(docId);\n            var doc = this.documents[key];\n\n            if (typeof doc === 'undefined') {\n                throw new Error(\"Doc not found in list: \" + key);\n            }\n\n            this.documents[key].addChildPub(publication);\n        }\n\n        return addChildPub;\n    }();\n\n    PublishedDocumentList.prototype.get = function () {\n        function get(docId) {\n            var key = valueOfId(docId);\n            return this.documents[key];\n        }\n\n        return get;\n    }();\n\n    PublishedDocumentList.prototype.remove = function () {\n        function remove(docId) {\n            var key = valueOfId(docId);\n            delete this.documents[key];\n        }\n\n        return remove;\n    }();\n\n    PublishedDocumentList.prototype.has = function () {\n        function has(docId) {\n            return !!this.get(docId);\n        }\n\n        return has;\n    }();\n\n    PublishedDocumentList.prototype.eachDocument = function () {\n        function eachDocument(callback, context) {\n            _.each(this.documents, function () {\n                function execCallbackOnDoc(doc) {\n                    callback.call(this, doc);\n                }\n\n                return execCallbackOnDoc;\n            }(), context || this);\n        }\n\n        return eachDocument;\n    }();\n\n    PublishedDocumentList.prototype.eachChildPub = function () {\n        function eachChildPub(docId, callback) {\n            var doc = this.get(docId);\n\n            if (doc) {\n                doc.eachChildPub(callback);\n            }\n        }\n\n        return eachChildPub;\n    }();\n\n    PublishedDocumentList.prototype.getIds = function () {\n        function getIds() {\n            var docIds = [];\n            this.eachDocument(function (doc) {\n                docIds.push(doc.docId);\n            });\n            return docIds;\n        }\n\n        return getIds;\n    }();\n\n    PublishedDocumentList.prototype.unflagForRemoval = function () {\n        function unflagForRemoval(docId) {\n            var doc = this.get(docId);\n\n            if (doc) {\n                doc.unflagForRemoval();\n            }\n        }\n\n        return unflagForRemoval;\n    }();\n\n    PublishedDocumentList.prototype.flagAllForRemoval = function () {\n        function flagAllForRemoval() {\n            this.eachDocument(function (doc) {\n                doc.flagForRemoval();\n            });\n        }\n\n        return flagAllForRemoval;\n    }();\n\n    return PublishedDocumentList;\n}();\n\nfunction valueOfId(docId) {\n    if (docId === null) {\n        throw new Error('Document ID is null');\n    }\n\n    if (typeof docId === 'undefined') {\n        throw new Error('Document ID is undefined');\n    }\n\n    return docId.valueOf();\n}\n\nmodule.exportDefault(PublishedDocumentList);","map":{"version":3,"sources":["packages/reywood:publish-composite/lib/published_document_list.js"],"names":["_","module","watch","require","v","PublishedDocument","PublishedDocumentList","documents","add","collectionName","docId","key","valueOfId","addChildPub","publication","doc","Error","get","remove","has","eachDocument","callback","context","each","execCallbackOnDoc","call","eachChildPub","getIds","docIds","push","unflagForRemoval","flagAllForRemoval","flagForRemoval","valueOf","exportDefault"],"mappings":"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","file":"packages/reywood:publish-composite/lib/published_document_list.js.map","sourcesContent":["import { _ } from 'meteor/underscore';\n\nimport PublishedDocument from './published_document';\n\n\nclass PublishedDocumentList {\n    constructor() {\n        this.documents = {};\n    }\n\n    add(collectionName, docId) {\n        const key = valueOfId(docId);\n\n        if (!this.documents[key]) {\n            this.documents[key] = new PublishedDocument(collectionName, docId);\n        }\n    }\n\n    addChildPub(docId, publication) {\n        if (!publication) { return; }\n\n        const key = valueOfId(docId);\n        const doc = this.documents[key];\n\n        if (typeof doc === 'undefined') {\n            throw new Error(`Doc not found in list: ${key}`);\n        }\n\n        this.documents[key].addChildPub(publication);\n    }\n\n    get(docId) {\n        const key = valueOfId(docId);\n        return this.documents[key];\n    }\n\n    remove(docId) {\n        const key = valueOfId(docId);\n        delete this.documents[key];\n    }\n\n    has(docId) {\n        return !!this.get(docId);\n    }\n\n    eachDocument(callback, context) {\n        _.each(this.documents, function execCallbackOnDoc(doc) {\n            callback.call(this, doc);\n        }, context || this);\n    }\n\n    eachChildPub(docId, callback) {\n        const doc = this.get(docId);\n\n        if (doc) {\n            doc.eachChildPub(callback);\n        }\n    }\n\n    getIds() {\n        const docIds = [];\n\n        this.eachDocument((doc) => {\n            docIds.push(doc.docId);\n        });\n\n        return docIds;\n    }\n\n    unflagForRemoval(docId) {\n        const doc = this.get(docId);\n\n        if (doc) {\n            doc.unflagForRemoval();\n        }\n    }\n\n    flagAllForRemoval() {\n        this.eachDocument((doc) => {\n            doc.flagForRemoval();\n        });\n    }\n}\n\nfunction valueOfId(docId) {\n    if (docId === null) {\n        throw new Error('Document ID is null');\n    }\n    if (typeof docId === 'undefined') {\n        throw new Error('Document ID is undefined');\n    }\n    return docId.valueOf();\n}\n\nexport default PublishedDocumentList;\n"]},"hash":"f3c6b2b80e47a3d89fc9f4d7b405b1bbdf69fdcb"}
