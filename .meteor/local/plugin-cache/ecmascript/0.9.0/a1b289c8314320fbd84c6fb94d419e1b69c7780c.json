{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"packages/reywood:publish-composite/lib/doc_ref_counter.js","filenameRelative":"packages/reywood:publish-composite/lib/doc_ref_counter.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],{"useNativeAsyncAwait":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"packages/reywood:publish-composite/lib/doc_ref_counter.js.map","sourceFileName":"packages/reywood:publish-composite/lib/doc_ref_counter.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"doc_ref_counter"},"ignored":false,"code":"class DocumentRefCounter {\n    constructor(observer) {\n        this.heap = {};\n        this.observer = observer;\n    }\n\n    increment(collectionName, docId) {\n        const key = `${collectionName}:${docId.valueOf()}`;\n\n        if (!this.heap[key]) {\n            this.heap[key] = 0;\n        }\n\n        this.heap[key] += 1;\n    }\n\n    decrement(collectionName, docId) {\n        const key = `${collectionName}:${docId.valueOf()}`;\n\n        if (this.heap[key]) {\n            this.heap[key] -= 1;\n            this.observer.onChange(collectionName, docId, this.heap[key]);\n        }\n    }\n\n}\n\nmodule.exportDefault(DocumentRefCounter);","map":{"version":3,"sources":["packages/reywood:publish-composite/lib/doc_ref_counter.js"],"names":["DocumentRefCounter","constructor","observer","heap","increment","collectionName","docId","key","valueOf","decrement","onChange","module","exportDefault"],"mappings":"AAAA,MAAMA,kBAAN,CAAyB;AACrBC,gBAAYC,QAAZ,EAAsB;AAClB,aAAKC,IAAL,GAAY,EAAZ;AACA,aAAKD,QAAL,GAAgBA,QAAhB;AACH;;AAEDE,cAAUC,cAAV,EAA0BC,KAA1B,EAAiC;AAC7B,cAAMC,MAAO,GAAEF,cAAe,IAAGC,MAAME,OAAN,EAAgB,EAAjD;;AACA,YAAI,CAAC,KAAKL,IAAL,CAAUI,GAAV,CAAL,EAAqB;AACjB,iBAAKJ,IAAL,CAAUI,GAAV,IAAiB,CAAjB;AACH;;AACD,aAAKJ,IAAL,CAAUI,GAAV,KAAkB,CAAlB;AACH;;AAEDE,cAAUJ,cAAV,EAA0BC,KAA1B,EAAiC;AAC7B,cAAMC,MAAO,GAAEF,cAAe,IAAGC,MAAME,OAAN,EAAgB,EAAjD;;AACA,YAAI,KAAKL,IAAL,CAAUI,GAAV,CAAJ,EAAoB;AAChB,iBAAKJ,IAAL,CAAUI,GAAV,KAAkB,CAAlB;AAEA,iBAAKL,QAAL,CAAcQ,QAAd,CAAuBL,cAAvB,EAAuCC,KAAvC,EAA8C,KAAKH,IAAL,CAAUI,GAAV,CAA9C;AACH;AACJ;;AArBoB;;AAAzBI,OAAOC,aAAP,CAwBeZ,kBAxBf","file":"packages/reywood:publish-composite/lib/doc_ref_counter.js.map","sourcesContent":["class DocumentRefCounter {\n    constructor(observer) {\n        this.heap = {};\n        this.observer = observer;\n    }\n\n    increment(collectionName, docId) {\n        const key = `${collectionName}:${docId.valueOf()}`;\n        if (!this.heap[key]) {\n            this.heap[key] = 0;\n        }\n        this.heap[key] += 1;\n    }\n\n    decrement(collectionName, docId) {\n        const key = `${collectionName}:${docId.valueOf()}`;\n        if (this.heap[key]) {\n            this.heap[key] -= 1;\n\n            this.observer.onChange(collectionName, docId, this.heap[key]);\n        }\n    }\n}\n\nexport default DocumentRefCounter;\n"]},"hash":"a1b289c8314320fbd84c6fb94d419e1b69c7780c"}
